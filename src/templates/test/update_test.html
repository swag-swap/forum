{% extends "base.html" %}
{% block content %}

<link href="/static/django_ckeditor_5/dist/styles.css" media="all" rel="stylesheet">
<script src="/static/django_ckeditor_5/dist/bundle.js"></script>


<form method="POST" action=".">
    <input type="hidden" name="csrfmiddlewaretoken" value="ir3Cg6LcsncQYn49C5qbsGFpqsBZf9vgpvCqGCBj702qC0aThooKeoV95iq8Rer6">
    <input type="file" id="nameFile" accept=".">
    <input type="file" id="tempFile" accept=".">
    <button onclick="sendFilesAsJSON()">Send Files</button>

    <script>
        function sendFilesAsJSON() {
  const nameFile = document.getElementById('nameFile').files[0];
  const tempFile = document.getElementById('tempFile').files[0];

  if (!nameFile || !tempFile) {
    alert('Please select both files before sending.');
    return;
  }

  const reader1 = new FileReader();
  const reader2 = new FileReader();

  reader1.onload = function() {
    const nameFileContent = reader1.result;

    reader2.onload = function() {
      const tempFileContent = reader2.result;

      const data = {
        nameFile: nameFileContent,
        tempFile: tempFileContent
      };

      sendDataToServer(data);
    }

    reader2.readAsText(tempFile);
  }

  reader1.readAsText(nameFile);
}

function sendDataToServer(data) {
  const xhr = new XMLHttpRequest();
  xhr.open('POST', window.location.href, true);
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.onreadystatechange = function() {
    if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
      console.log('Response:', xhr.responseText);
    }
  }
  xhr.send(JSON.stringify(data));
}
    </script>
 
</form>

{% endblock %}